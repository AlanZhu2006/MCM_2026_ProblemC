# 模型方法对比总结

## 可用的模型方法

### 1. 基础优化方法 (`fan_vote_estimator.py`)

**特点**：
- 使用优化算法（SLSQP）直接求解逆问题
- 简单直接，计算速度快
- 无不确定性量化

**适用场景**：
- 快速原型验证
- 计算资源有限

**运行方法**：
```bash
python scripts/run_stage2_fan_vote_estimation.py
```

---

### 2. 机器学习方法 (`fan_vote_estimator_ml.py`)

**特点**：
- 使用集成学习（Random Forest + Gradient Boosting + 线性模型）
- 自动特征学习
- 使用蒙特卡洛模拟进行不确定性量化

**适用场景**：
- 需要自动特征学习
- 数据量大

**运行方法**：
```bash
python scripts/run_stage2_ml_estimation.py
```

---

### 3. 高级ML方法 (`fan_vote_estimator_advanced.py`)

**特点**：
- 使用XGBoost/LightGBM（如果可用）
- 高级特征工程（时间序列、交互特征等）
- 时间序列交叉验证
- 更鲁棒的特征缩放（RobustScaler）

**适用场景**：
- 追求最高准确率
- 有充足的计算资源

**运行方法**：
```bash
python scripts/run_stage2_advanced_estimation.py
```

**依赖**：
```bash
pip install xgboost lightgbm
```

---

### 4. 状态空间模型方法 (`fan_vote_estimator_ssm.py`) ⭐ 新方法

**特点**：
- **借鉴2024年MCM C题的成功经验**
- 使用状态空间模型建模粉丝投票的动态演化
- 卡尔曼滤波实时估计粉丝投票的概率分布
- **自带不确定性量化**（协方差矩阵）
- 时间序列建模（考虑历史信息）

**适用场景**：
- 需要严格的不确定性量化
- 时间序列特性明显
- 需要理论基础强的模型
- 实时更新需求

**运行方法**：
```bash
python scripts/run_stage2_ssm_estimation.py
```

**依赖**（可选）：
```bash
pip install filterpy statsmodels
```

**核心思想**：
- 粉丝投票是隐变量（不可直接观测）
- 通过评委评分、历史表现等观测变量推断
- 状态方程：`fan_vote[t] = A * fan_vote[t-1] + B * judge_score[t] + w[t]`
- 观测方程：`y[t] = C * fan_vote[t] + D * judge_score[t] + v[t]`

---

## 方法对比表

| 特性 | 基础优化 | ML方法 | 高级ML | 状态空间模型 |
|------|---------|--------|--------|-------------|
| **准确率** | 中等 | 较高 | 最高 | 较高 |
| **不确定性量化** | ❌ | ✅ (蒙特卡洛) | ✅ (蒙特卡洛) | ✅ (协方差) |
| **时间序列建模** | ❌ | 部分 | 部分 | ✅ |
| **理论基础** | 中等 | 中等 | 中等 | **强** |
| **实时更新** | ❌ | ❌ | ❌ | ✅ |
| **计算速度** | 快 | 中等 | 较慢 | 中等 |
| **特征工程** | 手动 | 自动 | 自动+高级 | 手动 |
| **参数调优** | 简单 | 中等 | 复杂 | 中等 |

## 推荐使用策略

### 场景1：快速验证
**推荐**：基础优化方法
- 快速验证想法
- 计算资源有限

### 场景2：追求准确率
**推荐**：高级ML方法（XGBoost/LightGBM）
- 有充足的计算资源
- 追求最高准确率

### 场景3：需要不确定性量化
**推荐**：状态空间模型方法 ⭐
- 需要严格的不确定性量化
- 理论基础要求高
- 时间序列特性明显

### 场景4：平衡准确率和速度
**推荐**：ML方法
- 自动特征学习
- 计算速度适中
- 不确定性量化（蒙特卡洛）

## 组合使用策略

### 策略1：状态空间 + 优化
1. 使用状态空间模型提供初始估计和不确定性
2. 使用优化算法微调，确保约束满足

### 策略2：状态空间 + XGBoost
1. 使用状态空间模型提供初始值
2. 使用XGBoost进行特征学习和微调

### 策略3：集成多个方法
1. 分别使用不同方法估计
2. 加权平均或投票集成

## 2024年C题方法的借鉴

### 状态空间模型 + 卡尔曼滤波
- ✅ **已实现**：`fan_vote_estimator_ssm.py`
- 核心思想：将粉丝投票建模为隐变量，通过观测变量推断

### MCMC贝叶斯层级模型
- ⏳ **待实现**：可以使用PyMC3或Stan实现
- 优势：提供参数的不确定性

### ARIMA时间序列模型
- ⏳ **可扩展**：在状态空间模型中添加ARIMA组件
- 优势：捕捉周期性波动

### 聚类+分类组合
- ⏳ **可扩展**：使用K-means聚类选手，然后分类
- 优势：处理无标签数据

## 下一步改进方向

1. **实现MCMC贝叶斯层级模型**
   - 使用PyMC3或Stan
   - 提供参数的不确定性

2. **扩展状态空间模型**
   - 多变量状态（粉丝投票、人气、争议性）
   - 非线性模型（扩展卡尔曼滤波、粒子滤波）

3. **结合ARIMA模型**
   - 捕捉粉丝投票的周期性波动
   - 季节性分解

4. **马尔可夫模型**
   - 状态转移概率
   - 获胜概率计算

## 总结

**状态空间模型方法**是最新添加的方法，借鉴了2024年MCM C题的成功经验，特别适合：

1. ✅ **需要不确定性量化**的场景
2. ✅ **时间序列特性明显**的数据
3. ✅ **实时更新**的需求
4. ✅ **理论基础要求高**的论文

建议**先运行状态空间模型方法**，因为它提供了最完善的不确定性量化，并且有2024年C题的成功经验作为支撑！
